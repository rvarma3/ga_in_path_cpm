create table "EDWH_PROD"."WS_SKYWARDS_PROD".RUCH_GA_CPM_mem_details as

select
a56.person_id,
a57.LOYALTY_TIER,
a57.MEMBER_JOIN_DATE,
a58.COUNTRY_OF_RESIDENCE_CODE,
a58.COUNTRY_OF_RESIDENCE,
cast(array_agg(distinct a56.code) as string) as camp_code

from
"EDWH_PROD"."WS_SKYWARDS_PROD"."VW_SKYWARDS_SATELLITE_CRIS_CAMPAIGNS" as a56
left join
"EDWH_PROD"."GOLD"."SKYWARDS_MEMBER" as a57 on a56.person_id = a57.skywards_person_id
join
"EDWH_PROD"."GOLD"."CUSTOMER" as a58 on  a57.party_sk = a58.party_sk

where code in
(
'2020PC10WWTCCMPRD01',
'2020PC10WWTCCMPRD01',
'2020PC10WWTCCMPRD01',
'2020PC10WWTCCMPRD02',
'2020PC10WWTCCMPRD02',
'2020PC10WWTCCMPRD02',
'2021PC05WWTCCMCPM01',
'2021PC05WWTCCMCPM01',
'2021PC05WWTCCMCPM02'
) 
group by
a56.person_id,
a57.LOYALTY_TIER,
a57.MEMBER_JOIN_DATE,
a58.COUNTRY_OF_RESIDENCE_CODE,
a58.COUNTRY_OF_RESIDENCE

;